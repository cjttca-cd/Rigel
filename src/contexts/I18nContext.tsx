import type { ReactNode } from 'react';
import { createContext, useContext, useMemo } from 'react';

export type Lang = 'zh' | 'en' | 'ja';

const SUPPORTED_LANGS: Lang[] = ['zh', 'en', 'ja'];

type TranslationDict = Record<string, string>;

const translations: Record<Lang, TranslationDict> = {
    zh: {
        '加载中...': '加载中...',
        '处理中...': '处理中...',
        '财会助手 Rigel': '财会助手 Rigel',
        '首页': '首页',
        '账目管理': '账目管理',
        '报表中心': '报表中心',
        '用户': '用户',
        '退出登录': '退出登录',
        '退出': '退出',
        '语言': '语言',
        '中文': '中文',
        'English': 'English',
        '日本語': '日本語',
        '欢迎回来': '欢迎回来',
        '登录您的账户开始使用': '登录您的账户开始使用',
        '邮箱地址': '邮箱地址',
        '密码': '密码',
        '记住我': '记住我',
        '忘记密码？': '忘记密码？',
        '登录': '登录',
        '或者': '或者',
        '使用 Google 账户登录': '使用 Google 账户登录',
        '还没有账户？': '还没有账户？',
        '立即注册': '立即注册',
        '智能记账': '智能记账',
        '让财务更简单': '让财务更简单',
        'AI 驱动的智能记账系统，自动识别凭证、智能仕訳记录，助力企业财务效率提升。': 'AI 驱动的智能记账系统，自动识别凭证、智能仕訳记录，助力企业财务效率提升。',
        'AI 智能识别，自动生成仕訳': 'AI 智能识别，自动生成仕訳',
        '一键生成 試算表 和 総勘定元帳': '一键生成 試算表 和 総勘定元帳',
        '安全可靠，数据加密存储': '安全可靠，数据加密存储',
        '创建新账户': '创建新账户',
        '注册账户开始使用财会助手 Rigel': '注册账户开始使用财会助手 Rigel',
        '确认密码': '确认密码',
        '密码至少6位': '密码至少6位',
        '注册': '注册',
        '已有账户？': '已有账户？',
        '立即登录': '立即登录',
        '加入我们': '加入我们',
        '开启智能财务之旅': '开启智能财务之旅',
        '创建账户即可开始使用 AI 驱动的智能记账系统，体验高效、准确的财务管理。': '创建账户即可开始使用 AI 驱动的智能记账系统，体验高效、准确的财务管理。',
        '免费注册，即刻使用': '免费注册，即刻使用',
        '数据安全加密存储': '数据安全加密存储',
        '专业客服支持': '专业客服支持',
        '重置密码': '重置密码',
        '输入您的邮箱，我们将发送重置链接': '输入您的邮箱，我们将发送重置链接',
        '发送重置链接': '发送重置链接',
        '返回登录': '返回登录',
        '邮件已发送': '邮件已发送',
        '我们已向 {email} 发送了密码重置链接，请查收邮件。': '我们已向 {email} 发送了密码重置链接，请查收邮件。',
        '你好，{name}': '你好，{name}',
        '{month}概览': '{month}概览',
        '收入': '收入',
        '支出': '支出',
        'AI 仕訳助手': 'AI 仕訳助手',
        '有 {count} 条需要进行 AI 仕訳': '有 {count} 条需要进行 AI 仕訳',
        '立即处理': '立即处理',
        '所有仕訳已完成': '所有仕訳已完成',
        '近6月收支': '近6月收支',
        '近期编辑账目': '近期编辑账目',
        '查看全部': '查看全部',
        '暂无账目记录': '暂无账目记录',
        '快捷操作': '快捷操作',
        '新增账目': '新增账目',
        '月度收支统计': '月度收支统计',
        '生成財務諸表': '生成財務諸表',
        '試算表': '試算表',
        '各仕訳科目的借贷合计和余额': '各仕訳科目的借贷合计和余额',
        '查看': '查看',
        '総勘定元帳': '総勘定元帳',
        '按仕訳科目记录所有账目明细': '按仕訳科目记录所有账目明细',
        '仕訳帳': '仕訳帳',
        '账本，记录所有账目': '账本，记录所有账目',
        '未分类': '未分类',
        '未仕訳': '未仕訳',
        '已仕訳': '已仕訳',
        '修改': '修改',
        '未进行仕訳账目': '未进行仕訳账目',
        '筛选结果': '筛选结果',
        '加载更多': '加载更多',
        '已加载 {count} 条账目': '已加载 {count} 条账目',
        '（已全部加载）': '（已全部加载）',
        '已选 {count} 条': '已选 {count} 条',
        'AI仕訳': 'AI仕訳',
        '删除': '删除',
        '确认删除': '确认删除',
        '确定要删除选中的 {count} 条账目吗？此操作不可恢复。': '确定要删除选中的 {count} 条账目吗？此操作不可恢复。',
        'AI 仕訳': 'AI 仕訳',
        '确定要对选中的 {count} 条账目执行 AI 仕訳吗？': '确定要对选中的 {count} 条账目执行 AI 仕訳吗？',
        '执行': '执行',
        '编辑账目': '编辑账目',
        '确认': '确认',
        '取消': '取消',
        '保存': '保存',
        '创建': '创建',
        '概述（可指定仕訳項目）': '概述（可指定仕訳項目）',
        '请输入账目概述': '请输入账目概述',
        '类型': '类型',
        '请选择': '请选择',
        'AI识图': 'AI识图',
        '拍照或选择图片进行AI识别': '拍照或选择图片进行AI识别',
        '发生日期': '发生日期',
        '金额': '金额',
        '支付/收款方式': '支付/收款方式',
        '税务类型': '税务类型',
        '课税': '课税',
        '税率': '税率',
        '请选择税率': '请选择税率',
        '总课税额': '总课税额',
        '预估税额:': '预估税额:',
        '现金': '现金',
        '银行账户': '银行账户',
        '电子支付': '电子支付',
        '个人信用卡': '个人信用卡',
        '公司信用卡': '公司信用卡',
        '8%10%混合': '8%10%混合',
        '其他': '其他',
        '支付方式': '支付方式',
        '税额': '税额',
        '借方科目': '借方科目',
        '不可清空': '不可清空',
        '可为空': '可为空',
        '貸方科目': '貸方科目',
        '识别结果确认': '识别结果确认',
        '以下字段将被更新：': '以下字段将被更新：',
        '确认更新': '确认更新',
        '调整识别区域': '调整识别区域',
        '旋转 90°': '旋转 90°',
        '拖动图片调整位置，滚轮/捏合缩放': '拖动图片调整位置，滚轮/捏合缩放',
        '确认识别': '确认识别',
        '搜索列表内账目概述': '搜索列表内账目概述',
        '筛选': '筛选',
        '共 {count} 条': '共 {count} 条',
        '*勾选后可批量进行 仕訳 / 导出 / 删除': '*勾选后可批量进行 仕訳 / 导出 / 删除',
        '日期范围': '日期范围',
        '至': '至',
        '状态': '状态',
        '重置': '重置',
        '应用筛选': '应用筛选',
        '导出': '导出',
        '导出 CSV': '导出 CSV',
        '导出 PDF': '导出 PDF',
        'PDF 导出成功': 'PDF 导出成功',
        'PDF 导出失败': 'PDF 导出失败',
        'CSV 导出成功': 'CSV 导出成功',
        '导出全部総勘定元帳 PDF': '导出全部総勘定元帳 PDF',
        '共 {count} 个科目': '共 {count} 个科目',
        '导出仕訳帳': '导出仕訳帳',
        '导出仕訳帳 PDF': '导出仕訳帳 PDF',
        '导出試算表 PDF': '导出試算表 PDF',
        '导出総勘定元帳 PDF': '导出総勘定元帳 PDF',
        '全部 CSV (ZIP)': '全部 CSV (ZIP)',
        '全部 PDF (ZIP)': '全部 PDF (ZIP)',
        '关闭': '关闭',
        '合計': '合計',
        '借方残高': '借方残高',
        '借方合計': '借方合計',
        '貸方合計': '貸方合計',
        '貸方残高': '貸方残高',
        '勘定科目': '勘定科目',
        '账目总数': '账目总数',
        '条': '条',
        '选择科目：': '选择科目：',
        '请选择导出格式下载仕訳帳文件': '请选择导出格式下载仕訳帳文件',
        '月度统计图表': '月度统计图表',
        '柱状图': '柱状图',
        '折线图': '折线图',
        '请从上方下拉框选择一个科目': '请从上方下拉框选择一个科目',
        '查看该科目的月度占比趋势': '查看该科目的月度占比趋势',
        '占比': '占比',
        '収入（上方）': '収入（上方）',
        '支出（下方）': '支出（下方）',
        '※ 仅显示对象期间内有账目记录的月份': '※ 仅显示对象期间内有账目记录的月份',
        '选择报表类型': '选择报表类型',
        '设置与输出': '设置与输出',
        '近3个月': '近3个月',
        '近6个月': '近6个月',
        '近12个月': '近12个月',
        '开始日期': '开始日期',
        '结束日期': '结束日期',
        '生成报表': '生成报表',
        '已选择': '已选择',
        '试算表 生成成功': '試算表 生成成功',
        '総勘定元帳 生成成功': '総勘定元帳 生成成功',
        '仕訳帳 生成成功': '仕訳帳 生成成功',
        '月度收支统计 生成成功': '月度收支统计 生成成功',
        '请选择日期范围': '请选择日期范围',
        '日期范围内有 {count} 条账目未进行 AI 仕訳，正在跳转...': '日期范围内有 {count} 条账目未进行 AI 仕訳，正在跳转...',
        '报表生成失败': '报表生成失败',
        '汇总所有仕訳科目的借贷合计和余额，用于核对账目平衡': '汇总所有仕訳科目的借贷合计和余额，用于核对账目平衡',
        '按仕訳科目分类记录所有账目明细，便于查看每个科目的收支历史': '按仕訳科目分类记录所有账目明细，便于查看每个科目的收支历史',
        '完整的账本记录，按时间顺序记录所有账目': '完整的账本记录，按时间顺序记录所有账目',
        '可视化图表展示月度总收入和支出情况': '可视化图表展示月度总收入和支出情况',
        '没有搜索到符合条件的账目': '没有搜索到符合条件的账目',
        '请改变搜索条件再次尝试': '请改变搜索条件再次尝试',
        '未发现近期进行操作的账目': '未发现近期进行操作的账目',
        '点击上方"新增"按钮可添加账目，也可定义搜索条件进行搜索': '点击上方"新增"按钮可添加账目，也可定义搜索条件进行搜索',
        '全选': '全选',
        '已选择 {count} 项': '已选择 {count} 项',
        '收起详情': '收起详情',
        '展开详情': '展开详情',
        '更新': '更新',
        '编辑': '编辑',
        '借方：{item}': '借方：{item}',
        '貸方：{item}': '貸方：{item}',
        '税：{tax}': '税：{tax}',
        '非课税': '非课税',
        '8%（{amount}）': '8%（{amount}）',
        '10%（{amount}）': '10%（{amount}）',
        '混合（{amount}）': '混合（{amount}）',
        '其他（{amount}）': '其他（{amount}）',
        '未知': '未知',
        '公司名称': '公司名称',
        '例：株式会社 ○○○': '例：株式会社 ○○○',
        '公司名称将显示在 PDF 的页眉和页脚中。留空也可以导出。': '公司名称将显示在 PDF 的页眉和页脚中。留空也可以导出。',
        '操作失败，请重试': '操作失败，请重试',
        '登录成功': '登录成功',
        '登录失败': '登录失败',
        'Google登录失败': 'Google登录失败',
        '注册成功': '注册成功',
        '注册失败': '注册失败',
        '重置邮件已发送': '重置邮件已发送',
        '发送失败': '发送失败',
        '创建失败': '创建失败',
        '更新失败': '更新失败',
        '删除失败': '删除失败',
        '账目创建成功': '账目创建成功',
        '账目更新成功': '账目更新成功',
        '成功删除 {count} 条账目': '成功删除 {count} 条账目',
        'AI仕訳一次最多处理100条记录': 'AI仕訳一次最多处理100条记录',
        'AI仕訳处理完成': 'AI仕訳处理完成',
        'AI处理失败': 'AI处理失败',
        '加载更多失败': '加载更多失败',
        '请输入邮箱': '请输入邮箱',
        '邮箱格式不正确': '邮箱格式不正确',
        '请输入密码': '请输入密码',
        '两次密码不一致': '两次密码不一致',
        '该税率时必须输入税额': '该税率时必须输入税额',
        '借方科目不能清空': '借方科目不能清空',
        '贷方科目不能清空': '贷方科目不能清空',
        '请选择发生日期': '请选择发生日期',
        '请输入概述': '请输入概述',
        '金额必须大于0': '金额必须大于0',
        '请选择类型': '请选择类型',
        '请选择支付方式': '请选择支付方式',
        '请选择税务类型': '请选择税务类型',
        '识别结果与当前数据相同，无需更新': '识别结果与当前数据相同，无需更新',
        '识别失败，请手动输入': '识别失败，请手动输入'
    },
    en: {
        '加载中...': 'Loading...',
        '处理中...': 'Processing...',
        '财会助手 Rigel': 'Rigel Accounting Assistant',
        '首页': 'Home',
        '账目管理': 'Transactions',
        '报表中心': 'Reports',
        '用户': 'User',
        '退出登录': 'Sign out',
        '退出': 'Sign out',
        '语言': 'Lang',
        '中文': '中文',
        'English': 'English',
        '日本語': '日本語',
        '欢迎回来': 'Welcome back',
        '登录您的账户开始使用': 'Sign in to continue',
        '邮箱地址': 'Email address',
        '密码': 'Password',
        '记住我': 'Remember me',
        '忘记密码？': 'Forgot password?',
        '登录': 'Sign in',
        '或者': 'or',
        '使用 Google 账户登录': 'Sign in with Google',
        '还没有账户？': "Don't have an account?",
        '立即注册': 'Sign up now',
        '智能记账': 'Smart bookkeeping',
        '让财务更简单': 'Make finance simpler',
        'AI 驱动的智能记账系统，自动识别凭证、智能仕訳记录，助力企业财务效率提升。': 'An AI-powered bookkeeping system that recognizes vouchers and creates journal entries automatically.',
        'AI 智能识别，自动生成仕訳': 'AI recognition with automatic journal entries',
        '一键生成 試算表 和 総勘定元帳': 'One-click Trial Balance and General Ledger',
        '安全可靠，数据加密存储': 'Secure and encrypted data storage',
        '创建新账户': 'Create an account',
        '注册账户开始使用财会助手 Rigel': 'Register to start using Rigel',
        '确认密码': 'Confirm password',
        '密码至少6位': 'Password must be at least 6 characters',
        '注册': 'Sign up',
        '已有账户？': 'Already have an account?',
        '立即登录': 'Sign in',
        '加入我们': 'Join us',
        '开启智能财务之旅': 'Start your smart finance journey',
        '创建账户即可开始使用 AI 驱动的智能记账系统，体验高效、准确的财务管理。': 'Create an account to experience efficient, accurate AI bookkeeping.',
        '免费注册，即刻使用': 'Free registration, start now',
        '数据安全加密存储': 'Secure encrypted storage',
        '专业客服支持': 'Professional support',
        '重置密码': 'Reset password',
        '输入您的邮箱，我们将发送重置链接': 'Enter your email to receive a reset link',
        '发送重置链接': 'Send reset link',
        '返回登录': 'Back to sign in',
        '邮件已发送': 'Email sent',
        '我们已向 {email} 发送了密码重置链接，请查收邮件。': 'We sent a reset link to {email}.',
        '你好，{name}': 'Hi, {name}',
        '{month}概览': '{month} overview',
        '收入': 'Income',
        '支出': 'Expense',
        'AI 仕訳助手': 'AI Journal Assistant',
        '有 {count} 条需要进行 AI 仕訳': '{count} items need AI journal processing',
        '立即处理': 'Process now',
        '所有仕訳已完成': 'All journal entries are complete',
        '近6月收支': 'Last 6 months',
        '近期编辑账目': 'Recently edited',
        '查看全部': 'View all',
        '暂无账目记录': 'No records yet',
        '快捷操作': 'Quick actions',
        '新增账目': 'Add transaction',
        '月度收支统计': 'Monthly summary',
        '生成財務諸表': 'Generate reports',
        '試算表': 'Trial Balance',
        '各仕訳科目的借贷合计和余额': 'Totals and balances by account',
        '查看': 'View',
        '総勘定元帳': 'General Ledger',
        '按仕訳科目记录所有账目明细': 'All entries by account',
        '仕訳帳': 'Journal',
        '账本，记录所有账目': 'Complete journal records',
        '未分类': 'Uncategorized',
        '未仕訳': 'Unjournaled',
        '已仕訳': 'Journaled',
        '修改': 'Updated',
        '未进行仕訳账目': 'Unjournaled items',
        '筛选结果': 'Filtered results',
        '加载更多': 'Load more',
        '已加载 {count} 条账目': 'Loaded {count} items',
        '（已全部加载）': '(All loaded)',
        '已选 {count} 条': '{count} selected',
        'AI仕訳': 'AI Journal',
        '删除': 'Delete',
        '确认删除': 'Confirm deletion',
        '确定要删除选中的 {count} 条账目吗？此操作不可恢复。': 'Delete {count} selected items? This cannot be undone.',
        'AI 仕訳': 'AI Journal',
        '确定要对选中的 {count} 条账目执行 AI 仕訳吗？': 'Run AI journal on {count} selected items?',
        '执行': 'Run',
        '编辑账目': 'Edit transaction',
        '确认': 'Confirm',
        '取消': 'Cancel',
        '保存': 'Save',
        '创建': 'Create',
        '概述（可指定仕訳項目）': 'Description (optional journal account)',
        '请输入账目概述': 'Enter description',
        '类型': 'Type',
        '请选择': 'Select',
        'AI识图': 'AI Scan',
        '拍照或选择图片进行AI识别': 'Take a photo or upload to recognize',
        '发生日期': 'Transaction date',
        '金额': 'Amount',
        '支付/收款方式': 'Payment method',
        '税务类型': 'Tax type',
        '课税': 'Taxable',
        '税率': 'Tax rate',
        '请选择税率': 'Select tax rate',
        '总课税额': 'Taxable amount',
        '预估税额:': 'Estimated tax:',
        '现金': 'Cash',
        '银行账户': 'Bank account',
        '电子支付': 'E-wallet',
        '个人信用卡': 'Personal credit card',
        '公司信用卡': 'Company credit card',
        '8%10%混合': 'Mixed 8% / 10%',
        '其他': 'Other',
        '支付方式': 'Payment method',
        '税额': 'Tax amount',
        '借方科目': 'Debit account',
        '不可清空': 'Cannot be empty',
        '可为空': 'Optional',
        '貸方科目': 'Credit account',
        '识别结果确认': 'Confirm recognition',
        '以下字段将被更新：': 'The following fields will be updated:',
        '确认更新': 'Confirm update',
        '调整识别区域': 'Adjust scan area',
        '旋转 90°': 'Rotate 90°',
        '拖动图片调整位置，滚轮/捏合缩放': 'Drag to move, scroll/pinch to zoom',
        '确认识别': 'Confirm scan',
        '搜索列表内账目概述': 'Search descriptions',
        '筛选': 'Filter',
        '共 {count} 条': '{count} total',
        '*勾选后可批量进行 仕訳 / 导出 / 删除': '*Select to batch journal/export/delete',
        '日期范围': 'Date range',
        '至': 'to',
        '状态': 'Status',
        '重置': 'Reset',
        '应用筛选': 'Apply filters',
        '导出': 'Export',
        '导出 CSV': 'Export CSV',
        '导出 PDF': 'Export PDF',
        'PDF 导出成功': 'PDF exported successfully',
        'PDF 导出失败': 'PDF export failed',
        'CSV 导出成功': 'CSV exported successfully',
        '导出全部総勘定元帳 PDF': 'Export all ledger PDFs',
        '共 {count} 个科目': '{count} accounts',
        '导出仕訳帳': 'Export journal',
        '导出仕訳帳 PDF': 'Export journal PDF',
        '导出試算表 PDF': 'Export trial balance PDF',
        '导出総勘定元帳 PDF': 'Export ledger PDF',
        '全部 CSV (ZIP)': 'All CSV (ZIP)',
        '全部 PDF (ZIP)': 'All PDF (ZIP)',
        '关闭': 'Close',
        '合計': 'Total',
        '借方残高': 'Debit balance',
        '借方合計': 'Debit total',
        '貸方合計': 'Credit total',
        '貸方残高': 'Credit balance',
        '勘定科目': 'Account',
        '账目总数': 'Total records',
        '条': 'items',
        '选择科目：': 'Select account:',
        '请选择导出格式下载仕訳帳文件': 'Choose a format to download the journal',
        '月度统计图表': 'Monthly chart',
        '柱状图': 'Bar chart',
        '折线图': 'Line chart',
        '请从上方下拉框选择一个科目': 'Select an account from the dropdown above',
        '查看该科目的月度占比趋势': 'See monthly share trends for this account',
        '占比': 'Share',
        '収入（上方）': 'Income (top)',
        '支出（下方）': 'Expense (bottom)',
        '※ 仅显示对象期间内有账目记录的月份': '*Only months with records are shown',
        '选择报表类型': 'Select report type',
        '设置与输出': 'Settings & output',
        '近3个月': 'Last 3 months',
        '近6个月': 'Last 6 months',
        '近12个月': 'Last 12 months',
        '开始日期': 'Start date',
        '结束日期': 'End date',
        '生成报表': 'Generate report',
        '已选择': 'Selected',
        '试算表 生成成功': 'Trial balance generated',
        '総勘定元帳 生成成功': 'Ledger generated',
        '仕訳帳 生成成功': 'Journal generated',
        '月度收支统计 生成成功': 'Monthly report generated',
        '请选择日期范围': 'Select a date range',
        '日期范围内有 {count} 条账目未进行 AI 仕訳，正在跳转...': '{count} items are not journaled, redirecting...',
        '报表生成失败': 'Report generation failed',
        '汇总所有仕訳科目的借贷合计和余额，用于核对账目平衡': 'Totals and balances for reconciliation',
        '按仕訳科目分类记录所有账目明细，便于查看每个科目的收支历史': 'Entries grouped by account for history review',
        '完整的账本记录，按时间顺序记录所有账目': 'Full journal in chronological order',
        '可视化图表展示月度总收入和支出情况': 'Charts of monthly income and expense',
        '没有搜索到符合条件的账目': 'No matching records',
        '请改变搜索条件再次尝试': 'Try adjusting your filters',
        '未发现近期进行操作的账目': 'No recent records',
        '点击上方"新增"按钮可添加账目，也可定义搜索条件进行搜索': 'Use "Add" or set filters to search',
        '全选': 'Select all',
        '已选择 {count} 项': '{count} selected',
        '收起详情': 'Collapse',
        '展开详情': 'Expand',
        '更新': 'Updated',
        '编辑': 'Edit',
        '借方：{item}': 'Debit: {item}',
        '貸方：{item}': 'Credit: {item}',
        '税：{tax}': 'Tax: {tax}',
        '非课税': 'Non-taxable',
        '8%（{amount}）': '8% ({amount})',
        '10%（{amount}）': '10% ({amount})',
        '混合（{amount}）': 'Mixed ({amount})',
        '其他（{amount}）': 'Other ({amount})',
        '未知': 'Unknown',
        '公司名称': 'Company name',
        '例：株式会社 ○○○': 'Example: Example Co., Ltd.',
        '公司名称将显示在 PDF 的页眉和页脚中。留空也可以导出。': 'Company name appears in PDF header/footer. Leave blank to omit.',
        '操作失败，请重试': 'Operation failed. Try again.',
        '登录成功': 'Signed in',
        '登录失败': 'Sign-in failed',
        'Google登录失败': 'Google sign-in failed',
        '注册成功': 'Account created',
        '注册失败': 'Sign-up failed',
        '重置邮件已发送': 'Reset email sent',
        '发送失败': 'Send failed',
        '创建失败': 'Create failed',
        '更新失败': 'Update failed',
        '删除失败': 'Delete failed',
        '账目创建成功': 'Transaction created',
        '账目更新成功': 'Transaction updated',
        '成功删除 {count} 条账目': 'Deleted {count} items',
        'AI仕訳一次最多处理100条记录': 'AI journal max 100 records at a time',
        'AI仕訳处理完成': 'AI journal complete',
        'AI处理失败': 'AI processing failed',
        '加载更多失败': 'Failed to load more',
        '请输入邮箱': 'Enter email',
        '邮箱格式不正确': 'Invalid email format',
        '请输入密码': 'Enter password',
        '两次密码不一致': 'Passwords do not match',
        '该税率时必须输入税额': 'Tax amount required for this rate',
        '借方科目不能清空': 'Debit account cannot be empty',
        '贷方科目不能清空': 'Credit account cannot be empty',
        '请选择发生日期': 'Select a transaction date',
        '请输入概述': 'Enter description',
        '金额必须大于0': 'Amount must be greater than 0',
        '请选择类型': 'Select type',
        '请选择支付方式': 'Select payment method',
        '请选择税务类型': 'Select tax type',
        '识别结果与当前数据相同，无需更新': 'No changes detected',
        '识别失败，请手动输入': 'Recognition failed. Enter manually.'
    },
    ja: {
        '加载中...': '読み込み中...',
        '处理中...': '処理中...',
        '财会助手 Rigel': '会計アシスタント Rigel',
        '首页': 'ホーム',
        '账目管理': '取引管理',
        '报表中心': 'レポート',
        '用户': 'ユーザー',
        '退出登录': 'ログアウト',
        '退出': 'ログアウト',
        '语言': '言語',
        '中文': '中文',
        'English': 'English',
        '日本語': '日本語',
        '欢迎回来': 'おかえりなさい',
        '登录您的账户开始使用': 'アカウントにサインイン',
        '邮箱地址': 'メールアドレス',
        '密码': 'パスワード',
        '记住我': 'ログイン状態を保持',
        '忘记密码？': 'パスワードを忘れた？',
        '登录': 'ログイン',
        '或者': 'または',
        '使用 Google 账户登录': 'Googleでログイン',
        '还没有账户？': 'アカウントをお持ちでない方',
        '立即注册': '今すぐ登録',
        '智能记账': 'スマート記帳',
        '让财务更简单': '会計をもっとシンプルに',
        'AI 驱动的智能记账系统，自动识别凭证、智能仕訳记录，助力企业财务效率提升。': 'AIで領収書を認識し仕訳を自動化する記帳システム。',
        'AI 智能识别，自动生成仕訳': 'AI認識で仕訳を自動生成',
        '一键生成 試算表 和 総勘定元帳': '試算表と総勘定元帳をワンクリック生成',
        '安全可靠，数据加密存储': '安全な暗号化保存',
        '创建新账户': '新規アカウント作成',
        '注册账户开始使用财会助手 Rigel': 'Rigelの利用を開始',
        '确认密码': 'パスワード確認',
        '密码至少6位': 'パスワードは6文字以上',
        '注册': '登録',
        '已有账户？': 'すでにアカウントをお持ちですか？',
        '立即登录': 'ログイン',
        '加入我们': '参加しよう',
        '开启智能财务之旅': 'スマート会計を始めよう',
        '创建账户即可开始使用 AI 驱动的智能记账系统，体验高效、准确的财务管理。': 'アカウント作成でAI記帳を体験。',
        '免费注册，即刻使用': '無料で今すぐ利用',
        '数据安全加密存储': '安全な暗号化保存',
        '专业客服支持': 'プロのサポート',
        '重置密码': 'パスワード再設定',
        '输入您的邮箱，我们将发送重置链接': 'メールアドレスに再設定リンクを送ります',
        '发送重置链接': '再設定リンクを送信',
        '返回登录': 'ログインへ戻る',
        '邮件已发送': 'メールを送信しました',
        '我们已向 {email} 发送了密码重置链接，请查收邮件。': '{email} に再設定リンクを送信しました。',
        '你好，{name}': 'こんにちは、{name}',
        '{month}概览': '{month}の概要',
        '收入': '収入',
        '支出': '支出',
        'AI 仕訳助手': 'AI仕訳アシスタント',
        '有 {count} 条需要进行 AI 仕訳': 'AI仕訳が必要な取引が{count}件あります',
        '立即处理': '今すぐ処理',
        '所有仕訳已完成': '仕訳はすべて完了',
        '近6月收支': '直近6か月',
        '近期编辑账目': '最近の編集',
        '查看全部': 'すべて表示',
        '暂无账目记录': '取引がありません',
        '快捷操作': 'クイック操作',
        '新增账目': '取引を追加',
        '月度收支统计': '月次収支',
        '生成財務諸表': '財務レポート生成',
        '試算表': '試算表',
        '各仕訳科目的借贷合计和余额': '科目別の合計と残高',
        '查看': '表示',
        '総勘定元帳': '総勘定元帳',
        '按仕訳科目记录所有账目明细': '科目別に明細を表示',
        '仕訳帳': '仕訳帳',
        '账本，记录所有账目': 'すべての取引記録',
        '未分类': '未分類',
        '未仕訳': '未仕訳',
        '已仕訳': '仕訳済み',
        '修改': '更新',
        '未进行仕訳账目': '未仕訳の取引',
        '筛选结果': '絞り込み結果',
        '加载更多': 'さらに読み込む',
        '已加载 {count} 条账目': '{count}件読み込み済み',
        '（已全部加载）': '（すべて読み込み済み）',
        '已选 {count} 条': '{count}件選択',
        'AI仕訳': 'AI仕訳',
        '删除': '削除',
        '确认删除': '削除の確認',
        '确定要删除选中的 {count} 条账目吗？此操作不可恢复。': '{count}件を削除しますか？元に戻せません。',
        'AI 仕訳': 'AI仕訳',
        '确定要对选中的 {count} 条账目执行 AI 仕訳吗？': '{count}件にAI仕訳を実行しますか？',
        '执行': '実行',
        '编辑账目': '取引を編集',
        '确认': '確認',
        '取消': 'キャンセル',
        '保存': '保存',
        '创建': '作成',
        '概述（可指定仕訳項目）': '摘要（仕訳科目を指定可）',
        '请输入账目概述': '摘要を入力',
        '类型': '種類',
        '请选择': '選択',
        'AI识图': 'AI認識',
        '拍照或选择图片进行AI识别': '撮影または画像を選択して認識',
        '发生日期': '発生日',
        '金额': '金額',
        '支付/收款方式': '決済方法',
        '税务类型': '税区分',
        '课税': '課税',
        '税率': '税率',
        '请选择税率': '税率を選択',
        '总课税额': '課税対象額',
        '预估税额:': '推定税額:',
        '现金': '現金',
        '银行账户': '銀行口座',
        '电子支付': '電子決済',
        '个人信用卡': '個人クレジットカード',
        '公司信用卡': '法人クレジットカード',
        '8%10%混合': '8%/10%混合',
        '其他': 'その他',
        '支付方式': '決済方法',
        '税额': '税額',
        '借方科目': '借方科目',
        '不可清空': '空欄不可',
        '可为空': '空欄可',
        '貸方科目': '貸方科目',
        '识别结果确认': '認識結果の確認',
        '以下字段将被更新：': '次の項目が更新されます：',
        '确认更新': '更新を確定',
        '调整识别区域': '認識範囲を調整',
        '旋转 90°': '90°回転',
        '拖动图片调整位置，滚轮/捏合缩放': 'ドラッグで移動、スクロール/ピンチで拡大縮小',
        '确认识别': '認識を確定',
        '搜索列表内账目概述': '摘要で検索',
        '筛选': '絞り込み',
        '共 {count} 条': '合計{count}件',
        '*勾选后可批量进行 仕訳 / 导出 / 删除': '*選択して一括仕訳/エクスポート/削除',
        '日期范围': '期間',
        '至': '〜',
        '状态': '状態',
        '重置': 'リセット',
        '应用筛选': '適用',
        '导出': 'エクスポート',
        '导出 CSV': 'CSVを出力',
        '导出 PDF': 'PDFを出力',
        'PDF 导出成功': 'PDFの出力に成功しました',
        'PDF 导出失败': 'PDFの出力に失敗しました',
        'CSV 导出成功': 'CSVの出力に成功しました',
        '导出全部総勘定元帳 PDF': '総勘定元帳PDF（全科目）を出力',
        '共 {count} 个科目': '全{count}科目',
        '导出仕訳帳': '仕訳帳を出力',
        '导出仕訳帳 PDF': '仕訳帳PDFを出力',
        '导出試算表 PDF': '試算表PDFを出力',
        '导出総勘定元帳 PDF': '総勘定元帳PDFを出力',
        '全部 CSV (ZIP)': 'すべてCSV (ZIP)',
        '全部 PDF (ZIP)': 'すべてPDF (ZIP)',
        '关闭': '閉じる',
        '合計': '合計',
        '借方残高': '借方残高',
        '借方合計': '借方合計',
        '貸方合計': '貸方合計',
        '貸方残高': '貸方残高',
        '勘定科目': '勘定科目',
        '账目总数': '取引数',
        '条': '件',
        '选择科目：': '科目を選択：',
        '请选择导出格式下载仕訳帳文件': '形式を選択してダウンロード',
        '月度统计图表': '月次グラフ',
        '柱状图': '棒グラフ',
        '折线图': '折れ線グラフ',
        '请从上方下拉框选择一个科目': '上のプルダウンから選択',
        '查看该科目的月度占比趋势': '月次の割合推移を見る',
        '占比': '割合',
        '収入（上方）': '収入（上）',
        '支出（下方）': '支出（下）',
        '※ 仅显示对象期间内有账目记录的月份': '※期間内の月のみ表示',
        '选择报表类型': 'レポート種類を選択',
        '设置与输出': '設定と出力',
        '近3个月': '直近3か月',
        '近6个月': '直近6か月',
        '近12个月': '直近12か月',
        '开始日期': '開始日',
        '结束日期': '終了日',
        '生成报表': 'レポート生成',
        '已选择': '選択済み',
        '试算表 生成成功': '試算表を生成しました',
        '総勘定元帳 生成成功': '総勘定元帳を生成しました',
        '仕訳帳 生成成功': '仕訳帳を生成しました',
        '月度收支统计 生成成功': '月次収支を生成しました',
        '请选择日期范围': '期間を選択してください',
        '日期范围内有 {count} 条账目未进行 AI 仕訳，正在跳转...': '{count}件が未仕訳のため移動します...',
        '报表生成失败': 'レポート生成に失敗しました',
        '汇总所有仕訳科目的借贷合计和余额，用于核对账目平衡': '科目別の合計と残高で整合を確認',
        '按仕訳科目分类记录所有账目明细，便于查看每个科目的收支历史': '科目別の明細で履歴を確認',
        '完整的账本记录，按时间顺序记录所有账目': '時系列の仕訳帳',
        '可视化图表展示月度总收入和支出情况': '月次の収支を可視化',
        '没有搜索到符合条件的账目': '条件に一致する取引がありません',
        '请改变搜索条件再次尝试': '条件を変えて再試行してください',
        '未发现近期进行操作的账目': '最近の取引がありません',
        '点击上方"新增"按钮可添加账目，也可定义搜索条件进行搜索': '「追加」や条件で検索できます',
        '全选': 'すべて選択',
        '已选择 {count} 项': '{count}件選択',
        '收起详情': '詳細を閉じる',
        '展开详情': '詳細を開く',
        '更新': '更新',
        '编辑': '編集',
        '借方：{item}': '借方：{item}',
        '貸方：{item}': '貸方：{item}',
        '税：{tax}': '税：{tax}',
        '非课税': '非課税',
        '8%（{amount}）': '8%（{amount}）',
        '10%（{amount}）': '10%（{amount}）',
        '混合（{amount}）': '混合（{amount}）',
        '其他（{amount}）': 'その他（{amount}）',
        '未知': '不明',
        '公司名称': '会社名',
        '例：株式会社 ○○○': '例：株式会社 ○○○',
        '公司名称将显示在 PDF 的页眉和页脚中。留空也可以导出。': '会社名はPDFのヘッダー/フッターに表示されます。空欄可。',
        '操作失败，请重试': '操作に失敗しました。再試行してください。',
        '登录成功': 'ログイン成功',
        '登录失败': 'ログイン失敗',
        'Google登录失败': 'Googleログイン失敗',
        '注册成功': '登録完了',
        '注册失败': '登録失敗',
        '重置邮件已发送': '再設定メールを送信しました',
        '发送失败': '送信に失敗しました',
        '创建失败': '作成に失敗しました',
        '更新失败': '更新に失敗しました',
        '删除失败': '削除に失敗しました',
        '账目创建成功': '取引を作成しました',
        '账目更新成功': '取引を更新しました',
        '成功删除 {count} 条账目': '{count}件を削除しました',
        'AI仕訳一次最多处理100条记录': 'AI仕訳は最大100件まで',
        'AI仕訳处理完成': 'AI仕訳が完了しました',
        'AI处理失败': 'AI処理に失敗しました',
        '加载更多失败': '読み込みに失敗しました',
        '请输入邮箱': 'メールアドレスを入力してください',
        '邮箱格式不正确': 'メール形式が正しくありません',
        '请输入密码': 'パスワードを入力してください',
        '两次密码不一致': 'パスワードが一致しません',
        '该税率时必须输入税额': 'この税率では税額が必要です',
        '借方科目不能清空': '借方科目は空欄不可',
        '贷方科目不能清空': '貸方科目は空欄不可',
        '请选择发生日期': '発生日を選択してください',
        '请输入概述': '摘要を入力してください',
        '金额必须大于0': '金額は0より大きくしてください',
        '请选择类型': '種類を選択してください',
        '请选择支付方式': '決済方法を選択してください',
        '请选择税务类型': '税区分を選択してください',
        '识别结果与当前数据相同，无需更新': '変更がありません',
        '识别失败，请手动输入': '認識に失敗しました。手動で入力してください。'
    }
};

interface I18nContextValue {
    lang: Lang;
    t: (key: string, vars?: Record<string, string | number>) => string;
    withLang: (path: string) => string;
}

const I18nContext = createContext<I18nContextValue | undefined>(undefined);

interface I18nProviderProps {
    lang: Lang;
    children: ReactNode;
}

function interpolate(template: string, vars?: Record<string, string | number>) {
    if (!vars) return template;
    return template.replace(/\{(\w+)\}/g, (_, key) => String(vars[key] ?? ''));
}

export function I18nProvider({ lang, children }: I18nProviderProps) {
    const value = useMemo<I18nContextValue>(() => {
        const t = (key: string, vars?: Record<string, string | number>) => {
            const translation = translations[lang]?.[key] ?? translations.ja[key] ?? key;
            return interpolate(translation, vars);
        };
        const withLang = (path: string) => {
            const normalized = path.startsWith('/') ? path : `/${path}`;
            if (normalized === '/') return `/${lang}`;
            if (/^\/(zh|en|ja)(\/|$)/.test(normalized)) {
                return normalized;
            }
            return `/${lang}${normalized}`;
        };
        return { lang, t, withLang };
    }, [lang]);

    return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
}

export function useI18n() {
    const context = useContext(I18nContext);
    if (!context) {
        throw new Error('useI18n must be used within I18nProvider');
    }
    return context;
}

export function isSupportedLang(lang: string | undefined): lang is Lang {
    return !!lang && SUPPORTED_LANGS.includes(lang as Lang);
}

export const supportedLangs = SUPPORTED_LANGS;
